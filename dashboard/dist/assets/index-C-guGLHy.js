import{r as i,j as e,v as K,C as T}from"./index-wp0-z5g-.js";import{a as u,f as F,c as A,d as _,g,e as D}from"./index.esm-DPbDpRkl.js";import{k as X,m as P,n as $,o as q,p as G,q as O,g as Y,a as M,C as Z,h as ee,i as E,j as k,l as z}from"./DefaultLayout-DdBmS0sh.js";import{c as U}from"./cil-plus-D8mtC-W5.js";import{c as W}from"./cil-pencil-m516yCOw.js";import{c as J}from"./cil-trash-CBbKHhHb.js";import{b as Q,C as se,a as le}from"./CForm-DR_g0405.js";import{C as R}from"./CFormTextarea-CxUoDJVg.js";import{b as L}from"./CAlert-D1Sj_uBa.js";import"./cil-user-Ddrdy7PS.js";const ae=({items:d,setItems:b,isEditing:y})=>{const[j,c]=i.useState(!1),[r,S]=i.useState(null),[o,l]=i.useState({label:"",label_ar:"",text:"",text_ar:""}),p=(a=null)=>{if(a!==null){const s=d[a];l({label:s.label||"",label_ar:s.label_ar||"",text:s.text||"",text_ar:s.text_ar||""}),S(a)}else l({label:"",label_ar:"",text:"",text_ar:""}),S(null);c(!0)},n=a=>{a.preventDefault();const s=[...d];r!==null?s[r]={...s[r],...o}:s.push({...o,order:d.length}),b(s),c(!1)},N=a=>{window.confirm("Delete this manifesto statement?")&&b(d.filter((s,v)=>v!==a))},f=a=>l(s=>({...s,[a.target.name]:a.target.value}));return e.jsxs(e.Fragment,{children:[y&&e.jsxs(u,{color:"primary",size:"sm",className:"mb-3",onClick:()=>p(),children:[e.jsx(F,{icon:U,className:"me-1"})," Add Statement"]}),d.length===0?e.jsx("p",{className:"text-muted",children:"No manifesto statements yet."}):d.map((a,s)=>e.jsx("div",{className:"border rounded p-3 mb-2",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx(X,{color:"secondary",className:"me-2",children:s+1}),e.jsx("strong",{children:a.label||"Untitled"}),e.jsx("p",{className:"mb-0 mt-1 text-muted",children:a.text}),a.label_ar&&e.jsxs("p",{className:"mb-0 mt-1 text-muted",dir:"rtl",children:[a.label_ar,": ",a.text_ar]})]}),y&&e.jsxs("div",{className:"d-flex gap-1",children:[e.jsx(u,{color:"primary",size:"sm",variant:"ghost",onClick:()=>p(s),children:e.jsx(F,{icon:W})}),e.jsx(u,{color:"danger",size:"sm",variant:"ghost",onClick:()=>N(s),children:e.jsx(F,{icon:J})})]})]})},a._id||s)),e.jsxs(P,{visible:j,onClose:()=>c(!1),size:"lg",children:[e.jsx($,{children:e.jsx(q,{children:r!==null?"Edit Statement":"Add Statement"})}),e.jsxs(Q,{onSubmit:n,children:[e.jsxs(G,{children:[e.jsxs(A,{className:"mb-3",children:[e.jsxs(_,{md:6,children:[e.jsx(g,{children:"Label (EN) *"}),e.jsx(D,{name:"label",value:o.label,onChange:f,required:!0})]}),e.jsxs(_,{md:6,children:[e.jsx(g,{children:"Label (AR)"}),e.jsx(D,{name:"label_ar",value:o.label_ar,onChange:f,dir:"rtl"})]})]}),e.jsxs(A,{children:[e.jsxs(_,{md:6,children:[e.jsx(g,{children:"Text (EN) *"}),e.jsx(R,{name:"text",value:o.text,onChange:f,rows:3,required:!0})]}),e.jsxs(_,{md:6,children:[e.jsx(g,{children:"Text (AR)"}),e.jsx(R,{name:"text_ar",value:o.text_ar,onChange:f,rows:3,dir:"rtl"})]})]})]}),e.jsxs(O,{children:[e.jsx(u,{color:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(u,{type:"submit",color:"primary",children:r!==null?"Update":"Add"})]})]})]})]})},te=({gallery:d,onReload:b})=>{const[y,j]=i.useState(!1),[c,r]=i.useState(!1),[S,o]=i.useState(null),[l,p]=i.useState(null),[n,N]=i.useState("medium"),f=async s=>{if(s.preventDefault(),!l){o("Please select an image");return}r(!0),o(null);try{const v=new FormData;v.append("image",l),v.append("size",n);const C=await M.postWithFile("/admin/content/about/gallery",v);C!=null&&C.success?(j(!1),p(null),N("medium"),b()):o((C==null?void 0:C.message)||"Failed to add gallery item")}catch{o("Failed to add gallery item")}finally{r(!1)}},a=async s=>{if(window.confirm("Delete this gallery image?"))try{await M.delete(`/admin/content/about/gallery/${s}`),b()}catch{o("Failed to delete gallery item")}};return e.jsxs(e.Fragment,{children:[e.jsxs(u,{color:"primary",size:"sm",className:"mb-3",onClick:()=>j(!0),children:[e.jsx(F,{icon:U,className:"me-1"})," Add Image"]}),S&&e.jsx(L,{color:"danger",className:"mt-2",children:S}),d.length===0?e.jsx("p",{className:"text-muted",children:"No gallery images yet."}):e.jsx(A,{children:d.map(s=>e.jsx(_,{xs:6,md:3,className:"mb-3",children:e.jsxs("div",{className:"border rounded overflow-hidden",children:[e.jsx("img",{src:`${K}/${s.image}`,alt:"",style:{width:"100%",height:120,objectFit:"cover"}}),e.jsxs("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e.jsx("small",{className:"text-muted",children:s.size}),e.jsx(u,{color:"danger",size:"sm",variant:"ghost",onClick:()=>a(s._id),children:e.jsx(F,{icon:J})})]})]})},s._id))}),e.jsxs(P,{visible:y,onClose:()=>j(!1),children:[e.jsx($,{children:e.jsx(q,{children:"Add Gallery Image"})}),e.jsxs(Q,{onSubmit:f,children:[e.jsxs(G,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{children:"Image *"}),e.jsx(D,{type:"file",accept:"image/*",onChange:s=>p(s.target.files[0]),required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{children:"Size"}),e.jsxs(Y,{value:n,onChange:s=>N(s.target.value),children:[e.jsx("option",{value:"small",children:"Small"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"large",children:"Large"})]})]})]}),e.jsxs(O,{children:[e.jsx(u,{color:"secondary",onClick:()=>j(!1),disabled:c,children:"Cancel"}),e.jsxs(u,{type:"submit",color:"primary",disabled:c,children:[c&&e.jsx(T,{size:"sm",className:"me-1"})," Add"]})]})]})]})]})},h=({label:d,name:b,value:y,onChange:j,dir:c,disabled:r})=>e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{children:d}),e.jsx(D,{name:b,value:y,onChange:j,dir:c,disabled:r})]}),he=()=>{const[d,b]=i.useState(!0),[y,j]=i.useState(!1),[c,r]=i.useState(null),[S,o]=i.useState(null),[l,p]=i.useState(!1),[n,N]=i.useState({opening_line1:"",opening_line1_ar:"",opening_line2:"",opening_line2_ar:"",story_text:"",story_text_ar:"",story_image:"",finale_eyebrow:"",finale_eyebrow_ar:"",finale_subtitle:"",finale_subtitle_ar:"",finale_button_text:"",finale_button_text_ar:"",finale_button_link:""}),[f,a]=i.useState([]),[s,v]=i.useState([]),[C,B]=i.useState(null);i.useEffect(()=>{I()},[]);const I=async()=>{b(!0),r(null);try{const x=await M.get("/admin/content/about");if(x!=null&&x.data){const t=x.data;N({opening_line1:t.opening_line1||"",opening_line1_ar:t.opening_line1_ar||"",opening_line2:t.opening_line2||"",opening_line2_ar:t.opening_line2_ar||"",story_text:t.story_text||"",story_text_ar:t.story_text_ar||"",story_image:t.story_image||"",finale_eyebrow:t.finale_eyebrow||"",finale_eyebrow_ar:t.finale_eyebrow_ar||"",finale_subtitle:t.finale_subtitle||"",finale_subtitle_ar:t.finale_subtitle_ar||"",finale_button_text:t.finale_button_text||"",finale_button_text_ar:t.finale_button_text_ar||"",finale_button_link:t.finale_button_link||""}),a(t.manifesto||[]),v(t.gallery||[])}}catch{r("Failed to load about page data")}finally{b(!1)}},m=x=>N(t=>({...t,[x.target.name]:x.target.value})),V=async x=>{x.preventDefault(),j(!0),r(null),o(null);try{const t={...n,manifesto:f};delete t.story_image;const w=await M.put("/admin/content/about",t);if(C){const H=new FormData;H.append("image",C),await M.putWithFile("/admin/content/about/story-image",H)}w!=null&&w.success?(o("About page saved successfully!"),p(!1),B(null),I(),setTimeout(()=>o(null),3e3)):r((w==null?void 0:w.message)||"Failed to save")}catch{r("Failed to save about page")}finally{j(!1)}};return d?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:e.jsx(T,{color:"primary"})}):e.jsxs(se,{className:"mb-4",children:[e.jsxs(Z,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"About Page Content"}),l?e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(u,{color:"primary",size:"sm",onClick:V,disabled:y,children:[y&&e.jsx(T,{size:"sm",className:"me-1"})," Save All"]}),e.jsx(u,{color:"secondary",size:"sm",onClick:()=>{p(!1),I()},children:"Cancel"})]}):e.jsxs(u,{color:"primary",size:"sm",onClick:()=>p(!0),children:[e.jsx(F,{icon:W,className:"me-1"})," Edit"]})]}),e.jsxs(le,{children:[c&&e.jsx(L,{color:"danger",children:c}),S&&e.jsx(L,{color:"success",children:S}),e.jsxs(ee,{alwaysOpen:!0,children:[e.jsxs(E,{itemKey:1,children:[e.jsx(k,{children:"Scene 1 — Opening"}),e.jsx(z,{children:e.jsxs(A,{children:[e.jsxs(_,{md:6,children:[e.jsx(h,{label:"Line 1 (EN)",name:"opening_line1",value:n.opening_line1,onChange:m,disabled:!l}),e.jsx(h,{label:"Line 2 (EN)",name:"opening_line2",value:n.opening_line2,onChange:m,disabled:!l})]}),e.jsxs(_,{md:6,children:[e.jsx(h,{label:"Line 1 (AR)",name:"opening_line1_ar",value:n.opening_line1_ar,onChange:m,dir:"rtl",disabled:!l}),e.jsx(h,{label:"Line 2 (AR)",name:"opening_line2_ar",value:n.opening_line2_ar,onChange:m,dir:"rtl",disabled:!l})]})]})})]}),e.jsxs(E,{itemKey:2,children:[e.jsx(k,{children:"Scene 2 — Story"}),e.jsxs(z,{children:[e.jsxs(A,{className:"mb-3",children:[e.jsxs(_,{md:6,children:[e.jsx(g,{children:"Text (EN)"}),e.jsx(R,{name:"story_text",rows:3,value:n.story_text,onChange:m,disabled:!l})]}),e.jsxs(_,{md:6,children:[e.jsx(g,{children:"Text (AR)"}),e.jsx(R,{name:"story_text_ar",rows:3,value:n.story_text_ar,onChange:m,disabled:!l,dir:"rtl"})]})]}),e.jsx(g,{children:"Story Image"}),n.story_image&&e.jsx("div",{className:"mb-2",children:e.jsx("img",{src:`${K}/${n.story_image}`,alt:"Story",style:{maxHeight:150,borderRadius:8}})}),l&&e.jsx(D,{type:"file",accept:"image/*",onChange:x=>B(x.target.files[0])})]})]}),e.jsxs(E,{itemKey:3,children:[e.jsxs(k,{children:["Scene 3 — Manifesto (",f.length," statements)"]}),e.jsx(z,{children:e.jsx(ae,{items:f,setItems:a,isEditing:l})})]}),e.jsxs(E,{itemKey:4,children:[e.jsxs(k,{children:["Scene 4 — Gallery (",s.length," images)"]}),e.jsx(z,{children:e.jsx(te,{gallery:s,onReload:I})})]}),e.jsxs(E,{itemKey:5,children:[e.jsx(k,{children:"Scene 5 — Finale"}),e.jsxs(z,{children:[e.jsxs(A,{children:[e.jsxs(_,{md:6,children:[e.jsx(h,{label:"Eyebrow Text (EN)",name:"finale_eyebrow",value:n.finale_eyebrow,onChange:m,disabled:!l}),e.jsx(h,{label:"Subtitle (EN)",name:"finale_subtitle",value:n.finale_subtitle,onChange:m,disabled:!l}),e.jsx(h,{label:"Button Text (EN)",name:"finale_button_text",value:n.finale_button_text,onChange:m,disabled:!l})]}),e.jsxs(_,{md:6,children:[e.jsx(h,{label:"Eyebrow Text (AR)",name:"finale_eyebrow_ar",value:n.finale_eyebrow_ar,onChange:m,dir:"rtl",disabled:!l}),e.jsx(h,{label:"Subtitle (AR)",name:"finale_subtitle_ar",value:n.finale_subtitle_ar,onChange:m,dir:"rtl",disabled:!l}),e.jsx(h,{label:"Button Text (AR)",name:"finale_button_text_ar",value:n.finale_button_text_ar,onChange:m,dir:"rtl",disabled:!l})]})]}),e.jsx(h,{label:"Button Link",name:"finale_button_link",value:n.finale_button_link,onChange:m,disabled:!l})]})]})]})]})]})};export{he as default};
