import{r as i,j as e,C as T}from"./index-wp0-z5g-.js";import{a as m,f as u,c as k,d as j,g as v,e as H}from"./index.esm-DPbDpRkl.js";import{a as g,C as z,b as ne,c as ce,d as w,e as _,f as F,g as de}from"./DefaultLayout-DdBmS0sh.js";import{C as L,a as P,b as oe}from"./CForm-DR_g0405.js";import{c as me}from"./cil-pencil-m516yCOw.js";import{c as W}from"./cil-trash-CBbKHhHb.js";import{c as q}from"./cil-plus-D8mtC-W5.js";import{b as h}from"./CAlert-D1Sj_uBa.js";import{C as he}from"./CInputGroup-BVEkWfqB.js";import{C as J}from"./CFormTextarea-CxUoDJVg.js";import"./cil-user-Ddrdy7PS.js";var xe=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M479.6,399.716l-81.084-81.084-62.368-25.767A175.014,175.014,0,0,0,368,192c0-97.047-78.953-176-176-176S16,94.953,16,192,94.953,368,192,368a175.034,175.034,0,0,0,101.619-32.377l25.7,62.2L400.4,478.911a56,56,0,1,0,79.2-79.195ZM48,192c0-79.4,64.6-144,144-144s144,64.6,144,144S271.4,336,192,336,48,271.4,48,192ZM456.971,456.284a24.028,24.028,0,0,1-33.942,0l-76.572-76.572-23.894-57.835L380.4,345.771l76.573,76.572A24.028,24.028,0,0,1,456.971,456.284Z' class='ci-primary'/>"],ue=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M461,132,360,171.277V72H16V440H360V332.723L461,372h35V132Zm3,206.833-136-52.89V408H48V104H328V218.057l136-52.89Z' class='ci-primary'/>"];const we=()=>{var K;const[O,M]=i.useState(!0),[x,o]=i.useState(!1),[f,a]=i.useState(null),[C,d]=i.useState(null),[Q,p]=i.useState(!1),[I,y]=i.useState(!1),[n,E]=i.useState({title:"",title_ar:"",text:"",text_ar:""}),[b,V]=i.useState([]),[N,Z]=i.useState(""),[A,B]=i.useState(!1),[r,R]=i.useState(null),[$,X]=i.useState([]),[D,U]=i.useState("");i.useEffect(()=>{G(),Y()},[]);const G=async()=>{var s;M(!0),a(null);try{const t=await g.get("/admin/content/trending");if(t!=null&&t.data){const l=t.data;E({title:l.title||"",title_ar:l.title_ar||"",text:l.text||"",text_ar:l.text_ar||""}),V(l.reels||[]),y(l.title||l.title_ar||l.text||l.text_ar||((s=l.reels)==null?void 0:s.length)>0)}}catch(t){a("Failed to load data"),console.error(t)}finally{M(!1)}},Y=async()=>{try{const s=await g.get("/admin/content/courses-list");s!=null&&s.data&&X(s.data)}catch(s){console.error("Failed to load courses",s)}},S=s=>{const{name:t,value:l}=s.target;E(c=>({...c,[t]:l}))},ee=async s=>{s.preventDefault(),o(!0),a(null),d(null);try{const t=await g.put("/admin/content/trending",n);t!=null&&t.success?(d("Trending Course section saved successfully!"),y(!0),p(!1),setTimeout(()=>d(null),3e3)):a((t==null?void 0:t.message)||"Failed to save Trending Course section")}catch(t){a("Failed to save Trending Course section"),console.error(t)}finally{o(!1)}},se=async()=>{if(window.confirm("Are you sure you want to delete the Trending Course section content?")){o(!0),a(null);try{const s=await g.put("/admin/content/trending",{title:"",title_ar:"",text:"",text_ar:""});s!=null&&s.success&&(E({title:"",title_ar:"",text:"",text_ar:""}),y(b.length>0),d("Trending Course section deleted successfully!"),setTimeout(()=>d(null),3e3))}catch(s){a("Failed to delete Trending Course section"),console.error(s)}finally{o(!1)}}},te=()=>{p(!1),G()},le=async()=>{if(!N.trim()){a("Please enter a video ID");return}B(!0),a(null),R(null);try{const s=await g.get(`/admin/content/video/${N.trim()}`);s!=null&&s.success&&(s!=null&&s.data)?R(s.data):a((s==null?void 0:s.message)||"Failed to fetch video data")}catch(s){a("Failed to fetch video data. Please check the video ID."),console.error(s)}finally{B(!1)}},ae=async()=>{if(!r){a("Please fetch a video first");return}o(!0),a(null);try{const s={videoId:r.videoId,title:r.title,description:r.description,assets:r.assets};D&&(s.courseId=D);const t=await g.post("/admin/content/trending/reels",s);t!=null&&t.success?(V(t.data.reels||[]),R(null),Z(""),U(""),y(!0),d("Reel added successfully!"),setTimeout(()=>d(null),3e3)):a((t==null?void 0:t.message)||"Failed to add reel")}catch(s){a("Failed to add reel"),console.error(s)}finally{o(!1)}},ie=async s=>{var t;if(window.confirm("Are you sure you want to remove this reel?")){o(!0),a(null);try{const l=await g.delete(`/admin/content/trending/reels/${s}`);if(l!=null&&l.success){V(l.data.reels||[]),d("Reel removed successfully!"),setTimeout(()=>d(null),3e3);const c=l.data;y(c.title||c.title_ar||c.text||c.text_ar||((t=c.reels)==null?void 0:t.length)>0)}else a((l==null?void 0:l.message)||"Failed to remove reel")}catch(l){a("Failed to remove reel"),console.error(l)}finally{o(!1)}}};return O?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:e.jsx(T,{color:"primary"})}):Q?e.jsxs(L,{children:[e.jsx(z,{children:e.jsx("strong",{children:I?"Edit Trending Course Section":"Add Trending Course Section"})}),e.jsxs(P,{children:[f&&e.jsx(h,{color:"danger",children:f}),C&&e.jsx(h,{color:"success",children:C}),e.jsxs(oe,{onSubmit:ee,children:[e.jsxs(k,{className:"mb-4",children:[e.jsxs(j,{md:6,children:[e.jsx("h5",{children:"English Content"}),e.jsxs("div",{className:"mb-3",children:[e.jsx(v,{children:"Title (EN)"}),e.jsx(H,{name:"title",value:n.title,onChange:S,placeholder:"Enter English title"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(v,{children:"Text (EN)"}),e.jsx(J,{name:"text",value:n.text,onChange:S,placeholder:"Enter English text",rows:6})]})]}),e.jsxs(j,{md:6,children:[e.jsx("h5",{children:"Arabic Content"}),e.jsxs("div",{className:"mb-3",children:[e.jsx(v,{children:"Title (AR)"}),e.jsx(H,{name:"title_ar",value:n.title_ar,onChange:S,placeholder:"Enter Arabic title",dir:"rtl"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(v,{children:"Text (AR)"}),e.jsx(J,{name:"text_ar",value:n.text_ar,onChange:S,placeholder:"Enter Arabic text",rows:6,dir:"rtl"})]})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(m,{type:"submit",color:"primary",disabled:x,children:[x?e.jsx(T,{size:"sm",className:"me-2"}):null,"Save"]}),e.jsx(m,{type:"button",color:"secondary",onClick:te,disabled:x,children:"Cancel"})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(L,{className:"mb-4",children:[e.jsxs(z,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Trending Course Section"}),I?e.jsxs("div",{children:[e.jsxs(m,{color:"primary",size:"sm",className:"me-2",onClick:()=>p(!0),children:[e.jsx(u,{icon:me,className:"me-1"}),"Edit"]}),e.jsxs(m,{color:"danger",size:"sm",onClick:se,disabled:x,children:[e.jsx(u,{icon:W,className:"me-1"}),"Delete"]})]}):e.jsxs(m,{color:"primary",size:"sm",onClick:()=>p(!0),children:[e.jsx(u,{icon:q,className:"me-1"}),"Add Trending Course Section"]})]}),e.jsxs(P,{children:[f&&e.jsx(h,{color:"danger",children:f}),C&&e.jsx(h,{color:"success",children:C}),I||n.title||n.text?e.jsx(ne,{bordered:!0,children:e.jsxs(ce,{children:[e.jsxs(w,{children:[e.jsx(_,{style:{width:"200px"},children:"Title (EN)"}),e.jsx(F,{children:n.title||"-"})]}),e.jsxs(w,{children:[e.jsx(_,{children:"Title (AR)"}),e.jsx(F,{dir:"rtl",children:n.title_ar||"-"})]}),e.jsxs(w,{children:[e.jsx(_,{children:"Text (EN)"}),e.jsx(F,{style:{whiteSpace:"pre-wrap"},children:n.text||"-"})]}),e.jsxs(w,{children:[e.jsx(_,{children:"Text (AR)"}),e.jsx(F,{dir:"rtl",style:{whiteSpace:"pre-wrap"},children:n.text_ar||"-"})]})]})}):e.jsx(h,{color:"info",children:'No Trending Course section content configured yet. Click "Add Trending Course Section" to create one.'})]})]}),e.jsxs(L,{children:[e.jsx(z,{children:e.jsx("strong",{children:"Reels Videos"})}),e.jsxs(P,{children:[f&&e.jsx(h,{color:"danger",children:f}),C&&e.jsx(h,{color:"success",children:C}),e.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[e.jsx("h6",{className:"mb-3",children:"Add New Reel"}),e.jsxs(k,{className:"align-items-end",children:[e.jsxs(j,{md:6,children:[e.jsx(v,{children:"Video ID"}),e.jsxs(he,{children:[e.jsx(H,{placeholder:"Enter api.video Video ID (e.g., vi1KC3kffIRBF8PWgtSeMubL)",value:N,onChange:s=>Z(s.target.value),disabled:A}),e.jsxs(m,{color:"primary",onClick:le,disabled:A||!N.trim(),children:[A?e.jsx(T,{size:"sm"}):e.jsx(u,{icon:xe}),e.jsx("span",{className:"ms-1",children:"Fetch"})]})]})]}),e.jsxs(j,{md:4,children:[e.jsx(v,{children:"Link to Course"}),e.jsxs(de,{value:D,onChange:s=>U(s.target.value),children:[e.jsx("option",{value:"",children:"-- No Course --"}),$.map(s=>e.jsxs("option",{value:s._id,children:[s.name," ",s.name_ar?`- ${s.name_ar}`:""]},s._id))]})]})]}),r&&e.jsx("div",{className:"mt-3 p-3 bg-white rounded border",children:e.jsxs(k,{children:[e.jsx(j,{md:3,children:((K=r.assets)==null?void 0:K.thumbnail)&&e.jsx("img",{src:r.assets.thumbnail,alt:r.title,className:"img-fluid rounded",style:{maxHeight:"120px"}})}),e.jsxs(j,{md:7,children:[e.jsx("h6",{children:r.title}),e.jsx("p",{className:"text-muted mb-1",children:e.jsxs("small",{children:["Video ID: ",r.videoId]})}),r.description&&e.jsx("p",{className:"text-muted mb-0",children:e.jsx("small",{children:r.description})})]}),e.jsx(j,{md:2,className:"d-flex align-items-center justify-content-end",children:e.jsxs(m,{color:"success",onClick:ae,disabled:x,children:[x?e.jsx(T,{size:"sm"}):e.jsx(u,{icon:q}),e.jsx("span",{className:"ms-1",children:"Add"})]})})]})})]}),e.jsxs("h6",{className:"mb-3",children:["Current Reels (",b.length,")"]}),b.length===0?e.jsx(h,{color:"info",children:"No reels added yet. Use the form above to add reels by entering the Video ID."}):e.jsx("div",{className:"reels-list",children:b.map((s,t)=>{var l,c;return e.jsxs("div",{className:"d-flex align-items-center p-3 border rounded mb-2",children:[e.jsx("div",{className:"me-3",children:(l=s.assets)!=null&&l.thumbnail?e.jsx("img",{src:s.assets.thumbnail,alt:s.title,className:"rounded",style:{width:"80px",height:"60px",objectFit:"cover"}}):e.jsx("div",{className:"bg-secondary d-flex align-items-center justify-content-center rounded",style:{width:"80px",height:"60px"},children:e.jsx(u,{icon:ue,size:"lg",className:"text-white"})})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0",children:s.title||"Untitled"}),e.jsxs("small",{className:"text-muted",children:["ID: ",s.videoId]}),s.course&&e.jsx("div",{children:e.jsxs("small",{className:"text-primary",children:["Course: ",((c=$.find(re=>re._id===s.course))==null?void 0:c.name)||s.course]})})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"badge bg-secondary me-2",children:["#",t+1]}),e.jsx(m,{color:"danger",size:"sm",variant:"ghost",onClick:()=>ie(s.videoId),disabled:x,children:e.jsx(u,{icon:W})})]})]},s.videoId)})})]})]})]})};export{we as default};
