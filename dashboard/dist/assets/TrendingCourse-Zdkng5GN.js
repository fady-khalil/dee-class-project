import{r as a,j as e,C as w}from"./index-DwGczr7l.js";import{a as o,f as u,c as D,d as f,g as y,e as k}from"./index.esm-B4C_3RAI.js";import{a as C,C as H,b as se,c as te,d as S,e as F,f as I}from"./DefaultLayout-Bhot9-ca.js";import{C as z,a as L,b as le}from"./CForm-Du01ZZzy.js";import{c as ie}from"./cil-pencil-m516yCOw.js";import{c as $}from"./cil-trash-CBbKHhHb.js";import{c as G}from"./cil-plus-D8mtC-W5.js";import{b as h}from"./CAlert-CC772sW4.js";import{C as re}from"./CInputGroup-DVU8251E.js";import{C as K}from"./CFormTextarea-BGakudCY.js";import"./cil-user-Ddrdy7PS.js";var ae=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M479.6,399.716l-81.084-81.084-62.368-25.767A175.014,175.014,0,0,0,368,192c0-97.047-78.953-176-176-176S16,94.953,16,192,94.953,368,192,368a175.034,175.034,0,0,0,101.619-32.377l25.7,62.2L400.4,478.911a56,56,0,1,0,79.2-79.195ZM48,192c0-79.4,64.6-144,144-144s144,64.6,144,144S271.4,336,192,336,48,271.4,48,192ZM456.971,456.284a24.028,24.028,0,0,1-33.942,0l-76.572-76.572-23.894-57.835L380.4,345.771l76.573,76.572A24.028,24.028,0,0,1,456.971,456.284Z' class='ci-primary'/>"],ne=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M461,132,360,171.277V72H16V440H360V332.723L461,372h35V132Zm3,206.833-136-52.89V408H48V104H328V218.057l136-52.89Z' class='ci-primary'/>"];const ve=()=>{var U;const[W,P]=a.useState(!0),[m,d]=a.useState(!1),[j,i]=a.useState(null),[g,c]=a.useState(null),[q,p]=a.useState(!1),[E,v]=a.useState(!1),[n,_]=a.useState({title:"",title_ar:"",text:"",text_ar:""}),[b,V]=a.useState([]),[N,M]=a.useState(""),[A,Z]=a.useState(!1),[r,R]=a.useState(null);a.useEffect(()=>{B()},[]);const B=async()=>{var s;P(!0),i(null);try{const l=await C.get("/admin/content/trending");if(l!=null&&l.data){const t=l.data;_({title:t.title||"",title_ar:t.title_ar||"",text:t.text||"",text_ar:t.text_ar||""}),V(t.reels||[]),v(t.title||t.title_ar||t.text||t.text_ar||((s=t.reels)==null?void 0:s.length)>0)}}catch(l){i("Failed to load data"),console.error(l)}finally{P(!1)}},T=s=>{const{name:l,value:t}=s.target;_(x=>({...x,[l]:t}))},J=async s=>{s.preventDefault(),d(!0),i(null),c(null);try{const l=await C.put("/admin/content/trending",n);l!=null&&l.success?(c("Trending Course section saved successfully!"),v(!0),p(!1),setTimeout(()=>c(null),3e3)):i((l==null?void 0:l.message)||"Failed to save Trending Course section")}catch(l){i("Failed to save Trending Course section"),console.error(l)}finally{d(!1)}},O=async()=>{if(window.confirm("Are you sure you want to delete the Trending Course section content?")){d(!0),i(null);try{const s=await C.put("/admin/content/trending",{title:"",title_ar:"",text:"",text_ar:""});s!=null&&s.success&&(_({title:"",title_ar:"",text:"",text_ar:""}),v(b.length>0),c("Trending Course section deleted successfully!"),setTimeout(()=>c(null),3e3))}catch(s){i("Failed to delete Trending Course section"),console.error(s)}finally{d(!1)}}},Q=()=>{p(!1),B()},X=async()=>{if(!N.trim()){i("Please enter a video ID");return}Z(!0),i(null),R(null);try{const s=await C.get(`/admin/content/video/${N.trim()}`);s!=null&&s.success&&(s!=null&&s.data)?R(s.data):i((s==null?void 0:s.message)||"Failed to fetch video data")}catch(s){i("Failed to fetch video data. Please check the video ID."),console.error(s)}finally{Z(!1)}},Y=async()=>{if(!r){i("Please fetch a video first");return}d(!0),i(null);try{const s=await C.post("/admin/content/trending/reels",{videoId:r.videoId,title:r.title,description:r.description,assets:r.assets});s!=null&&s.success?(V(s.data.reels||[]),R(null),M(""),v(!0),c("Reel added successfully!"),setTimeout(()=>c(null),3e3)):i((s==null?void 0:s.message)||"Failed to add reel")}catch(s){i("Failed to add reel"),console.error(s)}finally{d(!1)}},ee=async s=>{var l;if(window.confirm("Are you sure you want to remove this reel?")){d(!0),i(null);try{const t=await C.delete(`/admin/content/trending/reels/${s}`);if(t!=null&&t.success){V(t.data.reels||[]),c("Reel removed successfully!"),setTimeout(()=>c(null),3e3);const x=t.data;v(x.title||x.title_ar||x.text||x.text_ar||((l=x.reels)==null?void 0:l.length)>0)}else i((t==null?void 0:t.message)||"Failed to remove reel")}catch(t){i("Failed to remove reel"),console.error(t)}finally{d(!1)}}};return W?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:e.jsx(w,{color:"primary"})}):q?e.jsxs(z,{children:[e.jsx(H,{children:e.jsx("strong",{children:E?"Edit Trending Course Section":"Add Trending Course Section"})}),e.jsxs(L,{children:[j&&e.jsx(h,{color:"danger",children:j}),g&&e.jsx(h,{color:"success",children:g}),e.jsxs(le,{onSubmit:J,children:[e.jsxs(D,{className:"mb-4",children:[e.jsxs(f,{md:6,children:[e.jsx("h5",{children:"English Content"}),e.jsxs("div",{className:"mb-3",children:[e.jsx(y,{children:"Title (EN)"}),e.jsx(k,{name:"title",value:n.title,onChange:T,placeholder:"Enter English title"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(y,{children:"Text (EN)"}),e.jsx(K,{name:"text",value:n.text,onChange:T,placeholder:"Enter English text",rows:6})]})]}),e.jsxs(f,{md:6,children:[e.jsx("h5",{children:"Arabic Content"}),e.jsxs("div",{className:"mb-3",children:[e.jsx(y,{children:"Title (AR)"}),e.jsx(k,{name:"title_ar",value:n.title_ar,onChange:T,placeholder:"Enter Arabic title",dir:"rtl"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(y,{children:"Text (AR)"}),e.jsx(K,{name:"text_ar",value:n.text_ar,onChange:T,placeholder:"Enter Arabic text",rows:6,dir:"rtl"})]})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(o,{type:"submit",color:"primary",disabled:m,children:[m?e.jsx(w,{size:"sm",className:"me-2"}):null,"Save"]}),e.jsx(o,{type:"button",color:"secondary",onClick:Q,disabled:m,children:"Cancel"})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(z,{className:"mb-4",children:[e.jsxs(H,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Trending Course Section"}),E?e.jsxs("div",{children:[e.jsxs(o,{color:"primary",size:"sm",className:"me-2",onClick:()=>p(!0),children:[e.jsx(u,{icon:ie,className:"me-1"}),"Edit"]}),e.jsxs(o,{color:"danger",size:"sm",onClick:O,disabled:m,children:[e.jsx(u,{icon:$,className:"me-1"}),"Delete"]})]}):e.jsxs(o,{color:"primary",size:"sm",onClick:()=>p(!0),children:[e.jsx(u,{icon:G,className:"me-1"}),"Add Trending Course Section"]})]}),e.jsxs(L,{children:[j&&e.jsx(h,{color:"danger",children:j}),g&&e.jsx(h,{color:"success",children:g}),E||n.title||n.text?e.jsx(se,{bordered:!0,children:e.jsxs(te,{children:[e.jsxs(S,{children:[e.jsx(F,{style:{width:"200px"},children:"Title (EN)"}),e.jsx(I,{children:n.title||"-"})]}),e.jsxs(S,{children:[e.jsx(F,{children:"Title (AR)"}),e.jsx(I,{dir:"rtl",children:n.title_ar||"-"})]}),e.jsxs(S,{children:[e.jsx(F,{children:"Text (EN)"}),e.jsx(I,{style:{whiteSpace:"pre-wrap"},children:n.text||"-"})]}),e.jsxs(S,{children:[e.jsx(F,{children:"Text (AR)"}),e.jsx(I,{dir:"rtl",style:{whiteSpace:"pre-wrap"},children:n.text_ar||"-"})]})]})}):e.jsx(h,{color:"info",children:'No Trending Course section content configured yet. Click "Add Trending Course Section" to create one.'})]})]}),e.jsxs(z,{children:[e.jsx(H,{children:e.jsx("strong",{children:"Reels Videos"})}),e.jsxs(L,{children:[j&&e.jsx(h,{color:"danger",children:j}),g&&e.jsx(h,{color:"success",children:g}),e.jsxs("div",{className:"mb-4 p-3 bg-light rounded",children:[e.jsx("h6",{className:"mb-3",children:"Add New Reel"}),e.jsx(D,{className:"align-items-end",children:e.jsxs(f,{md:6,children:[e.jsx(y,{children:"Video ID"}),e.jsxs(re,{children:[e.jsx(k,{placeholder:"Enter api.video Video ID (e.g., vi1KC3kffIRBF8PWgtSeMubL)",value:N,onChange:s=>M(s.target.value),disabled:A}),e.jsxs(o,{color:"primary",onClick:X,disabled:A||!N.trim(),children:[A?e.jsx(w,{size:"sm"}):e.jsx(u,{icon:ae}),e.jsx("span",{className:"ms-1",children:"Fetch"})]})]})]})}),r&&e.jsx("div",{className:"mt-3 p-3 bg-white rounded border",children:e.jsxs(D,{children:[e.jsx(f,{md:3,children:((U=r.assets)==null?void 0:U.thumbnail)&&e.jsx("img",{src:r.assets.thumbnail,alt:r.title,className:"img-fluid rounded",style:{maxHeight:"120px"}})}),e.jsxs(f,{md:7,children:[e.jsx("h6",{children:r.title}),e.jsx("p",{className:"text-muted mb-1",children:e.jsxs("small",{children:["Video ID: ",r.videoId]})}),r.description&&e.jsx("p",{className:"text-muted mb-0",children:e.jsx("small",{children:r.description})})]}),e.jsx(f,{md:2,className:"d-flex align-items-center justify-content-end",children:e.jsxs(o,{color:"success",onClick:Y,disabled:m,children:[m?e.jsx(w,{size:"sm"}):e.jsx(u,{icon:G}),e.jsx("span",{className:"ms-1",children:"Add"})]})})]})})]}),e.jsxs("h6",{className:"mb-3",children:["Current Reels (",b.length,")"]}),b.length===0?e.jsx(h,{color:"info",children:"No reels added yet. Use the form above to add reels by entering the Video ID."}):e.jsx("div",{className:"reels-list",children:b.map((s,l)=>{var t;return e.jsxs("div",{className:"d-flex align-items-center p-3 border rounded mb-2",children:[e.jsx("div",{className:"me-3",children:(t=s.assets)!=null&&t.thumbnail?e.jsx("img",{src:s.assets.thumbnail,alt:s.title,className:"rounded",style:{width:"80px",height:"60px",objectFit:"cover"}}):e.jsx("div",{className:"bg-secondary d-flex align-items-center justify-content-center rounded",style:{width:"80px",height:"60px"},children:e.jsx(u,{icon:ne,size:"lg",className:"text-white"})})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0",children:s.title||"Untitled"}),e.jsxs("small",{className:"text-muted",children:["ID: ",s.videoId]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"badge bg-secondary me-2",children:["#",l+1]}),e.jsx(o,{color:"danger",size:"sm",variant:"ghost",onClick:()=>ee(s.videoId),disabled:m,children:e.jsx(u,{icon:$})})]})]},s.videoId)})})]})]})]})};export{ve as default};
