import{e as z,r as l,j as e,C as v}from"./index-CUZ3IgtU.js";import{a as c,i}from"./index.esm-B2Pq-DPn.js";import{a as j,C as B,b as E,g as H,d as P,e as t,c as _,f as r,o as u,j as I,k as W,l as $,m as R,n as Z}from"./DefaultLayout-CkCiLseG.js";import{C as L,a as O}from"./CForm-mBsUD2F9.js";import{c as S}from"./cil-plus-D8mtC-W5.js";import{b as y}from"./CAlert-CT9IIZhY.js";import{c as U}from"./cil-check-circle-BlU9eaow.js";import{C as X}from"./CFormSwitch-YkhceUdR.js";import{c as Y}from"./cil-pencil-m516yCOw.js";import{c as q}from"./cil-trash-CBbKHhHb.js";import"./cil-user-Ddrdy7PS.js";var G=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='348.071 141.302 260.308 229.065 172.545 141.302 149.917 163.929 237.681 251.692 149.917 339.456 172.545 362.083 260.308 274.32 348.071 362.083 370.699 339.456 282.935 251.692 370.699 163.929 348.071 141.302' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M425.706,86.294A240,240,0,0,0,86.294,425.706,240,240,0,0,0,425.706,86.294ZM256,464C141.309,464,48,370.691,48,256S141.309,48,256,48s208,93.309,208,208S370.691,464,256,464Z' class='ci-primary'/>"];const ie=()=>{const x=z(),[k,C]=l.useState(!0),[m,D]=l.useState([]),[f,a]=l.useState(null),[p,g]=l.useState(null),[M,d]=l.useState(!1),[n,b]=l.useState(null),[w,N]=l.useState(!1);l.useEffect(()=>{h()},[]);const h=async()=>{C(!0),a(null);try{const s=await j.get("/admin/plans");s!=null&&s.success?D(s.data||[]):a("Failed to load plans")}catch(s){a("Failed to load plans"),console.error(s)}finally{C(!1)}},T=s=>{b(s),d(!0)},A=async()=>{if(n){N(!0),a(null);try{const s=await j.delete(`/admin/plans/${n._id}`);s!=null&&s.success?(g("Plan deleted successfully"),d(!1),b(null),h(),setTimeout(()=>g(null),3e3)):a((s==null?void 0:s.message)||"Failed to delete plan")}catch(s){a("Failed to delete plan"),console.error(s)}finally{N(!1)}}},F=async s=>{try{const o=await j.patch(`/admin/plans/${s._id}/toggle-status`);o!=null&&o.success&&h()}catch(o){console.error(o)}};return k&&m.length===0?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:e.jsx(v,{color:"primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs(L,{children:[e.jsxs(B,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Subscription Plans"}),e.jsxs(c,{color:"primary",onClick:()=>x("/plans/new"),children:[e.jsx(i,{icon:S,className:"me-1"}),"Add Plan"]})]}),e.jsxs(O,{children:[f&&e.jsx(y,{color:"danger",children:f}),p&&e.jsx(y,{color:"success",children:p}),m.length===0?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("h5",{className:"text-muted mb-3",children:"No plans found"}),e.jsx("p",{className:"text-muted mb-4",children:"Create your first subscription plan to get started."}),e.jsxs(c,{color:"primary",onClick:()=>x("/plans/new"),children:[e.jsx(i,{icon:S,className:"me-1"}),"Create First Plan"]})]}):e.jsxs(E,{hover:!0,responsive:!0,align:"middle",children:[e.jsx(H,{color:"light",children:e.jsxs(P,{children:[e.jsx(t,{style:{width:"60px"},children:"Order"}),e.jsx(t,{children:"Plan Name"}),e.jsx(t,{children:"Monthly"}),e.jsx(t,{children:"Yearly"}),e.jsx(t,{style:{width:"80px"},children:"Profiles"}),e.jsx(t,{style:{width:"80px"},children:"Download"}),e.jsx(t,{style:{width:"80px"},children:"Status"}),e.jsx(t,{style:{width:"100px"},children:"Actions"})]})}),e.jsx(_,{children:m.map(s=>e.jsxs(P,{children:[e.jsx(r,{className:"text-center",children:e.jsx(u,{color:"secondary",children:s.order})}),e.jsxs(r,{children:[e.jsxs("div",{className:"fw-semibold",children:[s.title,s.isPopular&&e.jsx(u,{color:"warning",className:"ms-2",children:"Popular"})]}),e.jsx("small",{className:"text-muted",children:s.title_ar})]}),e.jsxs(r,{children:[e.jsxs("div",{className:"fw-semibold text-primary",children:[s.monthlyPrice," ",s.currency]}),e.jsx("small",{className:"text-muted text-truncate d-block",style:{maxWidth:"120px"},children:s.monthlyStripePriceId})]}),e.jsxs(r,{children:[e.jsxs("div",{className:"fw-semibold text-success",children:[s.yearlyPrice," ",s.currency]}),e.jsx("small",{className:"text-muted text-truncate d-block",style:{maxWidth:"120px"},children:s.yearlyStripePriceId})]}),e.jsx(r,{className:"text-center",children:e.jsx(u,{color:"info",children:s.profilesAllowed})}),e.jsx(r,{className:"text-center",children:s.canDownload?e.jsx(i,{icon:U,className:"text-success",size:"lg"}):e.jsx(i,{icon:G,className:"text-danger",size:"lg"})}),e.jsx(r,{children:e.jsx(X,{checked:s.isActive,onChange:()=>F(s),title:s.isActive?"Click to deactivate":"Click to activate"})}),e.jsxs(r,{children:[e.jsx(c,{color:"primary",size:"sm",variant:"ghost",onClick:()=>x(`/plans/edit/${s._id}`),className:"me-1",title:"Edit",children:e.jsx(i,{icon:Y})}),e.jsx(c,{color:"danger",size:"sm",variant:"ghost",onClick:()=>T(s),title:"Delete",children:e.jsx(i,{icon:q})})]})]},s._id))})]})]})]}),e.jsxs(I,{visible:M,onClose:()=>d(!1),children:[e.jsx(W,{children:e.jsx($,{children:"Delete Plan"})}),e.jsxs(R,{children:[e.jsxs("p",{children:["Are you sure you want to delete ",e.jsx("strong",{children:n==null?void 0:n.title}),"?"]}),e.jsxs(y,{color:"warning",className:"mb-0",children:[e.jsx("strong",{children:"Warning:"})," Users currently subscribed to this plan will not be affected, but no new subscriptions can be made to this plan."]})]}),e.jsxs(Z,{children:[e.jsx(c,{color:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsxs(c,{color:"danger",onClick:A,disabled:w,children:[w&&e.jsx(v,{size:"sm",className:"me-2"}),"Delete Plan"]})]})]})]})};export{ie as default};
